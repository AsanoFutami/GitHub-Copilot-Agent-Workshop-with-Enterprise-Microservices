# GitHub Copilot Agent ワークショップ - スキーショップ マイクロサービス編（Java 21 + Spring Boot）

![Ski Shop Image](./design-docs/ski-shop.png)

このワークショップの参加者は、新しいチームメンバーです。会社の異動や組織変更により新しいプロジェクトに配属され、GitHub Copilot Agent Mode を使って既存の実装を素早く理解し、新機能を実装することが求められています。

このワークショップは、実際のエンタープライズレベルの Spring Boot マイクロサービスアーキテクチャに基づいており、現在のエンラープライズ Java アプリケーションの開発における実践スキルを身につける上で直接役立つ内容をお届けします。

> 注:  
> このマイクロサービスプロジェクト（9つのマイクロサービス、460以上のJavaファイル）は、GitHub CopilotのAgentモードを使い、わずか数日で作成されました。Copilotを効果的に活用すれば、この規模のプロジェクトであっても圧倒的な短期間で実装が可能です。

## ワークショップ準備

### 必要な環境

- Visual Studio Code/Eclipse/IntelliJ IDEA + GitHub Copilot
- Java 21 (OpenJDK or Oracle JDK)
- Maven 3.8+
- ブラウザ（Edge/Chrome/Firefox 推奨）
- Docker & Docker Compose（オプション）
- PostgreSQL（オプション、Dockerコンテナ可）
- Redis（オプション、Dockerコンテナ可）

### 事前インストールコマンド

```bash
# Java 21インストール確認
java -version
# Mavenインストール確認
mvn -version
```

### プロジェクト構成

```plaintext
ski-shop-microservices/
├── frontend-service/             # Thymeleafフロントエンド（デュアルテーマ）
├── api-gateway/                  # Spring Cloud Gateway
├── authentication-service/       # Azure Entra ID OAuth 2.0
├── user-management-service/      # RBAC付きユーザー管理
├── inventory-management-service/ # JPAによる在庫管理
├── payment-cart-service/         # Redisによる決済・カート
├── sales-management-service/     # 受注管理
├── point-service/                # ポイント＆ランクシステム
├── coupon-service/               # クーポン・キャンペーン管理
├── ai-support-service/           # LangChain4jによるAI機能
├── monitoring/                   # Prometheus & Grafana
├── scripts/                      # DB初期化
└── all-endpoint-list.md          # API仕様（163エンドポイント）
```

## 「AI活用による効率的なシステム理解と開発」

### ワークショップ概要

- **所要時間**: 2時間〜
- **対象**: 初級〜上級（段階別難易度）
- **テーマ**: 9マイクロサービス(Java21 + Spring Boot)から成るスキーショップシステムの理解と拡張
- **ゴール**: Copilot Agentで全体構造を理解し、システム機能拡張を実装する

### システム概要

本ワークショップの対象システムは、**Java 21**および**Spring Boot 3.2**で構築された、以下9つのマイクロサービスで構成されています。

1. **Authentication Service** - Azure Entra ID OAuth 2.0連携認証・認可サービス
2. **User Management Service** - RBAC付きユーザー管理サービス
3. **Inventory Management Service** - JPA + PostgreSQLによる在庫管理
4. **Sales Management Service** - 分散トランザクション対応の受注管理
5. **Payment Cart Service** - Redisセッション管理の決済・カート管理サービス
6. **Point Service** - ランク付きポイント管理システム
7. **Coupon Service** - キャンペーン機能付きクーポン管理
8. **AI Support Service** - LangChain4jを用いたAIサポートサービス
9. **API Gateway** - Spring Cloud GatewayによるAPIルーティング
10. **Frontend Service** - ThymeleafベースのWebフロント（顧客/管理テーマ）

- **総エンドポイント数**: 163（一般ユーザー: 99 管理者: 64）
- **技術スタック**: Java 21, Spring Boot 3.2, Spring Security, Spring Data JPA, Spring Cloud Gateway, Thymeleaf, PostgreSQL, Redis, LangChain4j, Maven, Docker

## パート1: 初級編（30分） - 「システム概要の理解」

### 1.1 システム探索（10分）

**ストーリー**: 新任開発者としてまずシステム全体像を把握しましょう

**実践内容**:

```plaintext
「このシステムにはどんなサービスがあるか？各サービスの役割を教えてください。」
「各サービスのフォルダ構成を見せてください。」
「このシステムはどんな技術スタックを使っていますか？」
「プロジェクトルートのファイル説明をお願いします。」
```

**学びのポイント**:

- Copilot Agentによるワークスペース解析
- プロジェクト構成の自動把握
- 技術要素の識別スキル
- ドキュメント解析能力

**想定回答例**:

- 9マイクロサービスの役割一覧
- Spring Boot 3.2 + Java 21のアーキテクチャ分析
- Mavenマルチモジュール構成の解説
- docker-composeによるサービスDocker化設定
- PostgreSQL・Redis連携パターン

### 1.2 APIエンドポイント理解（10分）

**ストーリー**: サポート担当になったつもりで 実装内容を理解し、障害対応に備えます

**実践内容**:

```plaintext
「ユーザーログインはどのAPIを使うべきですか？」
「商品検索用のAPIとして何が利用できますか？」
「注文作成のAPIフローがどのように実装されているか説明してください。」
「ポイント API について詳しく教えてください。」
「クーポン適用処理の流れを詳しく説明してください。」
```

**学びのポイント**:

- 自然言語による API 検索スキル
- 業務機能と API の対応関係の把握
- エンドポイント間の依存関係を理解
- RESTful API設計の理解

### 1.3 データベース設計の理解（10分）

**ストーリー**: データ分析チームの一員として、どんなデータがどこに格納されるかを理解します

**実践内容**:

```plaintext
「このシステム上に存在するデータベーステーブルの一覧を教えてください？」
「ユーザー情報はどこに格納されますか？」
「注文データと商品データの関係を詳しく説明してください。」
「ポイント・クーポンのデータ構造を詳しく Markdown の ER 図を交えて教えてください。」
```

**学びのポイント**:

- DBスキーマ自動解析
- エンティティ間リレーションの理解
- データモデリングパターンの学習
- マイクロサービス間でのデータ分散設計

### 1.4 参加者チームによる、分析結果の内容を発表 (3-5分)

参加者チームの代表者により分析した内容を発表します。

## パート2: 中級編（45分）-「認証およびユーザー管理のビジネスロジック詳細な理解」

このセクションでは、システム基盤となる認証サービスとユーザー管理サービスの緊密な連携について深堀りして理解します。

- **焦点**: Authentication Service ↔ User Management Service の詳細な実装内容の解析
- **所要時間**: 45分
- **学習目標**: サービス間通信・データ整合性・セキュリティトークン・イベント伝播パターンの理解

---

### 2.1: ２つのマイクロサービス間の詳細な理解（10分）

#### 2.1.1 サービス関係概要

```plaintext
「Authentication Service と User Management Service の関係を詳しく分析してください：
- 各サービスの主担当範囲
- ユーザー登録時はどのように連携するのか
- ユーザーログイン時の連携
- サービス間で共有されるデータ
- 責務境界・分離の考え方
- ユーザーIDの管理方法」
```

#### 2.1.2 統合アーキテクチャ分析

```plaintext
「両サービス間の統合アーキテクチャを説明してください：
- サービス間の通信方法
- 通信プロトコル（REST/メッセージング/イベント等）
- サービス間のDB直結有無
- データ整合性維持の仕組み
- 片方のサービスダウン時の挙動
- 分散トランザクションの扱い」
```

#### 2.1.3 データフロー概要

```plaintext
「Authentication Service と User Management Service のデータ・フローを詳しく説明してください：
- User Management → Authenticationへ送られるユーザー情報
- Authentication → User Management への認証データ
- プロフィール更新の同期
- 権限変更の反映方法
- 双方のデータ同期トリガー」
```

### 2.2: 詳細実装解析（15分）

#### 2.2.1 Authentication Service詳細

```plaintext
「Authentication Service 実装詳細を分析してください：
- Azure Entra ID OAuth 2.0統合方法
- OAuth構成設定箇所
- JWTトークン生成・検証方法
- ローカル保存ユーザー情報と外部取得情報
- トークン有効期限・リフレッシュ処理
- 実装されているセキュリティフィルター/インターセプター
- 役割・権限管理の仕組み」
```

#### 2.2.2 User Management Service詳細

```plaintext
「User Management Service 詳細を分析してください：
- ユーザーエンティティおよびテーブル定義
- ユーザー登録のバリデーションと処理フロー
- 管理するプロフィール項目
- 権限・ロールの保存・管理方法
- ユーザー生命周期管理ビジネスルール
- ユーザー有効化／無効化／削除の扱い
- 他サービスがユーザー情報を参照するAPI群」
```

#### 2.2.3 サービス間通信パターン

```plaintext
「Authentication ServiceとUser Management Serviceの通信パターン:
- Authentication Serviceが呼び出すUser Management ServiceのRESTエンドポイント
- User Management Serviceが呼び出すAuthentication ServiceのRESTエンドポイント
- サービス間認証・認可の実装
- エラー・リトライ処理
- サービスディスカバリ・ロードバランシング設定
- 非同期通信パターン（イベント・メッセージング等）有無
- APIコントラクト・バージョン管理」
```

#### 2.2.4 データ整合性・同期

```plaintext
「両サービス間のデータ整合性維持メカニズム分析：
- 認証データとプロフィールデータ間の最終的整合性維持方法
- どちらかでデータ更新があったときの両サービス同期策
- 両者に同ユーザーデータがある場合の競合解消
- DBトランザクションパターン
- 障害発生時のデータ保全策
- データ照合・修復処理有無」
```

### 2.3: セキュリティ・トークンフロー詳細解析（10分）

#### 2.3.1 認証フロー追跡

```plaintext
「両サービス間の認証フロー詳細を追跡してください：
- Azure Entra ID経由のログインステップバイステップ
- OAuthコールバック処理詳細
- ログイン時のUser Management Service との情報交換
- 権限・ロールのフェッチ・キャッシュ
- ユーザーセッションの確立・維持
- 次回APIリクエスト時のトークンバリデーション」
```

#### 2.3.2 認可・ロール管理

```plaintext
「両サービス間の認可メカニズムを分析してください：
- ユーザーロールの定義・保存場所
- ロールベースアクセス制御の権威サービス
- 両サービスでの@PreAuthorize利用例
- 管理者権限の管理・検証方法
- サービス間で共有されるセキュリティコンテキスト
- クロスサービス認可の保護方法」
```

#### 2.3.3 セキュリティトークンのライフサイクル

```plaintext
「セキュリティトークンのライフサイクルを説明してください：
- JWTトークンの構造と持つクレーム
- User Management Serviceによるトークン検証
- リフレッシュシナリオの詳細
- 期限切れ・失効時の挙動
- ログアウト時のトークン無効化
- セキュリティヘッダ・CORS設定」
```

### 2.4: ローカル環境テスト／検証（10分）

#### 2.4.1 セットアップ手順

```plaintext
「認証サービスとユーザー管理サービスのローカル統合テスト手順を詳述してください：
- 必要なソフトウェア・設定
- 両サービスのDB接続設定
- ローカル開発用Azure Entra ID設定
- application.yml/propertiesへの必要設定
- 必須環境変数のセットアップ
- 機密情報のローカル管理方法
- 正しい起動順序」
```

#### 2.4.2 統合テストシナリオ

```plaintext
「両サービス統合検証のための具体的なテストシナリオ：
- エンドツーエンドのユーザー登録フロー
- Azure Entra ID OAuthログイン検証
- プロフィール更新・同期検証
- サービス横断の権限制御検証
- サービス間通信モニタリングツール
- 障害・タイムアウト時の検証
- 統合トラブル時のログ確認箇所」
```

#### 2.4.3 APIテスト＆検証

```plaintext
「両サービスのAPIテスト手順を段階的に整理してください：
- 認証エンドポイントのcurlまたはPostman利用例
- JWTトークンの取得・後続API利用手順
- 管理者専用エンドポイント検証
- 認証コンテキストからのユーザー管理APIテスト
- 主要統合点のリクエスト／レスポンス例
- クロスサービスAPIコール検証
- サービスヘルス確認用エンドポイント」
```

#### 2.4.4 DB・データ検証

```plaintext
「両サービス間のデータ整合性検証方法：
- 両サービスのDBスキーマ・データを確認する手順
- ユーザーデータ同期確認用SQLクエリ例
- ロール・権限が正しく格納されているかの確認方法
- トークンとプロフィールのリンク確認
- おすすめローカルDBツール
- テストデータリセット手順
- 注意すべきDBマイグレーションスクリプト」
```

#### 2.4.5 トラブルシューティング

```plaintext
「両サービス統合でのよくある問題の解決ガイド：
- 代表的な設定誤りと対応法
- サービス間認証失敗デバッグ法
- デバッグ向けログレベル・パターンの設定
- サービス間APIコール追跡とパフォーマンス監視法
- 典型的なエラーメッセージと意味
- ネットワーク疎通やサービスディスカバリ確認
- 問題個所特定のための監視ツール」
```

### 2.5 参加者チームによる、分析結果の内容を発表 (3-5分)

参加者チームの代表者により分析した内容を発表します。

**学びのポイント**:

- Spring Bootマイクロサービスにおける複雑なビジネスロジックの理解
- Spring Cloudを使ったサービス連携設計
- エラー対応・例外管理手法
- Javaのドメイン駆動設計（DDD）パターン
- JPAによるエンティティ関係・トランザクション管理の解析

**学習効果**:

- Spring Bootマイクロサービスの協調処理の把握
- Spring Dataによる分散トランザクションパターンの検証
- JPAを使った在庫・ポイント・クーポン業務システム連携の理解

## パート3: 上級編（45分） -「新フロントエンドサービスの実装」

**このワークショップを始める前に、既存の `Frontend Service` ディレクトリはリネームまたは削除しておいてください。**

### 3.1. フロントエンド要件分析（10分）

**ストーリー**: フロントエンドアーキテクトとして、既存に替わる新フロントエンド・サービスをゼロから設計・実装します

**実践内容**:

```plaintext
「design-docs/frontend-design.md を元にフロント要件を分析してください。」
「all-endpoint-list.mdからフロントが利用すべきAPIを洗い出してください。」
「一般ユーザーと管理者の機能要件の違いは？」
「デュアルテーマフロントエンドのアーキテクチャ設計はどうあるべきか？」
「新フロントエンド・マイクロサービスの推奨技術スタックは？」
「顧客・管理者両方のインタフェースに拡張しやすいプロジェクト構造は？」
「必要な認証・認可連携設計は？」
「新フロント開発用の計画を立ててください。」
```

**分析ポイント**:

- 顧客用：99エンドポイントにアクセス／ライトブルーテーマ
- 管理者用：64エンドポイントにアクセス／ライトレッドテーマ
- 技術スタック：Java21 + Spring Boot 3.2 + Thymeleaf + Bootstrap
- 認証：Azure Entra ID OAuth 2.0連携
- レスポンシブ：両テーマともモバイル対応

### 3.2 顧客向けフロント構築（15分）

**ストーリー**: Spring Boot開発者として顧客向け（ライトブルー）画面を構築します

**実践内容**:

```plaintext
「新Spring Bootフロントエンド・マイクロサービスプロジェクトを作成してください。」
「指定テーマで顧客画面を実装してください。」
「all-endpoint-list.mdに基づき以下ページを実装：
- トップページ（商品ショーケース・検索）
- 商品カタログ、商品詳細
- カート・チェックアウト
- ユーザープロフィール・注文履歴
- ポイント・クーポン管理
- AIチャットサポート画面
」
「各ページにつき：
- Thymeleaf + ライトブルー配色（#E3F2FD, #BBDEFB, #90CAF9）
- Bootstrapレスポンシブ
- 各機能のAPI統合（all-endpoint-list.md）
- 適切なエラーハンドリング
- ナビゲーション/認証状態表示
」
「要件：
- 商品検索: GET /api/products/search
- カート操作: POST /api/v1/cart/items
- 注文: POST /api/v1/orders
- ポイント確認: GET /api/v1/points/balance
- AI推薦: GET /api/v1/recommendations/{userId}
」
```

**技術ポイント**:

- Spring Boot 3.2 + Maven初期構成
- 顧客用MVCコントローラ
- Thymeleaf + ライトブルーテーマ
- Bootstrapによるレスポンシブ
- RestTemplate/WebClientによるAPI連携
- Spring Security認証制御
- バリデーション/エラーハンドリング
- AJAXによる動的コンテンツ

### 3.3 管理者ダッシュボード実装（15分）

**ストーリー**: バックエンド開発者としてライトレッドテーマの管理画面を構築

**実践内容**:

```plaintext
「管理者画面を設計ドキュメントに基づきライトレッドテーマで実装してください。」
「all-endpoint-list.mdに基づき以下管理者ページを実装：  
- 管理ダッシュボード（統計）  
- 商品・在庫管理  
- 受注・出荷管理  
- ユーザー管理・ロール割当  
- レポート・分析  
- キャンペーン・クーポン管理  
」  
「各管理画面につき：  
- Thymeleaf + ライトレッド配色（#FFEBEE, #FFCDD2, #EF9A9A）  
- 管理画面用データテーブル  
- バッチ操作UI  
- データ可視化チャート  
- 管理者専用のロール制御  
- 管理操作監査ログ記録  
」  
「主要API連携例：  
- 商品管理: POST /api/products, PUT /api/categories/{id}  
- 注文管理: PUT /api/v1/orders/{orderId}/status  
- ユーザー管理: GET /api/admin/users  
- レポート: GET /api/v1/reports/sales  
- キャンペーン管理: POST /api/v1/campaigns  
」  
「追加機能:  
- WebSocketによるリアルタイム監視  
- レポート出力（PDF、Excel）  
- 一括ユーザー・商品編集  
- 高度な検索・フィルタ  
- システムヘルス監視・アラート」
```

**技術ポイント**:

- 管理用MVCコントローラ
- ライトレッドThymeleaf＋CSS  
- ページネーション付き表  
- Chart.jsによる可視化  
- WebSocketリアルタイム  
- ファイルエクスポート  
- ロールベースセキュリティ  
- バッチ処理

### 3.4 フロントサービス統合テスト（5分）

**ストーリー**: フルスタック開発者としてフロントエンド統合・検証

**実践内容**:

```plaintext
「新フロントエンド統合・テスト手順をサポートしてください：
- application.ymlの適切な設定例  
- pom.xmlへの必要依存追加  
- API Gatewayとの統合設計  
- 双方（顧客・管理）の統合テスト作成  
- APIコールのエラーハンドリング・フォールバック実装  
- デュアルテーマ向けセキュリティ設定  
- Azure Entra ID連携の認証フロー  
- フロントエンドヘルスチェック・監視実装例  
」  
「テストシナリオ例:  
- 顧客による購入フローのE2E  
- 管理者のユーザー管理ワークフロー  
- APIエラー時挙動  
- 認証・認可フロー  
- クロスブラウザ互換性  
- レスポンシブ表示検証  
- ページロード性能テスト」
```

**統合ポイント**:

- API Gatewayルーティング設定
- 認証サービス連携  
- エラー／サーキットブレーカー実装  
- キャッシュ戦略  
- セキュリティヘッダ／CORS設定  
- 監視・ログ統合  

**Copilot Agent利用例**:

```plaintext
「新規Spring Bootフロントエンドプロジェクト構成を生成してください。」
「顧客画面用ライトブルーThymeleafテンプレート生成」  
「管理画面用ライトレッドThymeleafテンプレート生成」  
「双方のMVCコントローラ自動生成」  
「all-endpoint-list.mdベースでDTOクラスも自動生成」  
「RestTemplate/WebClientでAPIクライアント実装」  
「包括的なエラーハンドリングおよびバリデーション」  
「双方のテーマ用Bootstrap/CSSコンポーネント出力」  
「デュアルテーマ用Spring Security設定」  
「双方ワークフローの統合テスト自動生成」  
「必須依存関係を含むpom.xml・application.ymlの自動生成」  
「フロントキャッシュ戦略自動化」  
「監視・ヘルスチェックエンドポイント実装」  
```

### 3.5: レビュー＆デモ（10分）

### 完全演習＆デモンストレーション

**ストーリー**: プロジェクトマネージャーの立場で新フロントをステークホルダーに紹介します

### 実践内容

```plaintext  
「顧客向け新サイト（ライトブルー）のデモをお願いします。」  
「新しい管理ダッシュボード（ライトレッド）を紹介してください。」  
「フロントエンドとバックエンドマイクロサービスの統合方法を説明してください。」  
「新フロントサービスの統合を含めた全体アーキテクチャ図を作成してください。」  
「GitHub Copilot Agentがフロント開発でどのように役立ったかまとめてください。」  
「デュアルテーマの設計選択の理由を説明してください。」  
「異なるデバイスでのレスポンシブデザイン機能を見せてください。」  
「フロントエンドが用いているAPI連携パターンを教えてください。」
```

## ワークショップの学習効果とCopilot Agent活用パターン

### 1. 段階的スキルアップ

- **初級**: 情報収集・全体理解
- **中級**: ビジネスロジック解析・サービス間統合理解
- **上級**: 新規マイクロサービス開発（フロント含む）

### 2. 多様なCopilot Agent活用法

- **情報収集・解析**: ワークスペース解析、Spring Bootプロジェクト観察、アーキテクチャ自動可視化
- **コード生成**: Spring Bootマイクロサービス一式、Thymeleafテンプレート、MVCコントローラ等
- **統合実装**: APIクライアント生成、認証連携、エラー処理
- **デザイン実装**: デュアルテーマUI生成、レスポンシブデザイン、UX向上

### 3. 実践適用法

- Spring Bootマイクロサービスシステムの既存解析・ドキュメント化
- 新機能開発時の影響分析
- フロントエンドマイクロサービスのスクラッチ実装
- AIペアプログラミングによる大規模Java開発の生産性向上
- エンタープライズ向けデュアルテーマWebアプリ開発

### 4. 成果物

- **理解成果**: 完全なマイクロサービス構成ドキュメント
- **実装成果**:
  - 新規マイクロサービス一式
  - 顧客画面（99エンドポイント統合）
  - 管理者ダッシュボード（64エンドポイント統合）
  - 各テーマのレスポンシブデザイン
  - バックエンド全マイクロサービス連携
- **知識成果**: エンタープライズJavaでのCopilot Agent実践ノウハウ

## 期待する学習成果

本ワークショップで得られるスキル：

1. **システム理解力**: Copilot Agentを使ったエンタープライズJavaプロジェクト解析スキル
2. **開発効率向上**: JavaエコシステムでのAIペアプログラミングによる生産性改善法
3. **新機能実装力**: Spring Boot＋Thymeleafによる新規フロントエンド構築スキル
4. **統合知識**: マイクロサービス通信/連携パターンとAPIインテグレーション手法
5. **UI/UX設計**: デュアルテーマ・レスポンシブデザイン設計パターン
6. **実務適用力**: エンタープライズJavaプロジェクトでのCopilot Agent活用法

---

## 追加ワークショップ: 未実装機能の実装

本プロジェクトにはまだ未実装（`//TODO`）の部分がたくさん残っています。
GitHub Copilot Agent ModeやCoding Agentを活用して、これらの未実装機能も一つずつ実装していきましょう。

## 付録: GitHub Copilot Agent向け実践プロンプト例

本セクションでは、Spring Bootマイクロサービスシステムの分析・理解に役立つ具体的なプロンプト例を紹介します。

### 1. システム概要解析用プロンプト

#### 1.1 システム全体理解

- **目的**: 全マイクロサービス構成・技術・アーキテクチャ・データ・セキュリティの俯瞰的理解
- **想定結果**: 構造、サービス、技術スタック、データ管理、セキュリティ等の全体像が掴める

```text
「このスキーショップマイクロサービスプロジェクトを分析し、以下をまとめてください：
- すべてのマイクロサービスと主な役割
- システムで使われている技術スタック（Javaバージョン、Spring Bootバージョン、DBなど）
- 全体アーキテクチャのパターン（API Gateway、サービスディスカバリ等）
- サービス間の通信手法
- セキュリティ実装方針
- 各サービスのデータ管理方法」
```

#### 1.2 プロジェクト構成分析

- **目的**: コードベースや開発周辺資産の配置やモジュール化方針を理解する
- **想定結果**: Maven構成、Docker化、DB初期化スクリプト、監視資産等が整理できる

```text
「プロジェクト構成を調べてください：
- Mavenマルチモジュール構成/依存
- Docker/コンテナ化設定
- DB初期化スクリプトと設定
- モニタリング（Prometheus, Grafana等）
- 開発/デプロイワークフロー」
```

#### 1.3 ビジネスドメイン理解

- **目的**: 業務背景や価値提供内容への理解を深める
- **想定結果**: 商品、顧客フロー、主要業務ルール、AI機能の業務面説明が可能になる  

```text
「このスキーショップシステムのビジネスドメインを説明してください：
- どんな商品・サービスを提供しているか
- サポートされる代表的な顧客導線
- サービス横断のビジネスルール
- ポイント・クーポン機能
- AIサポート機能の概要」
```

### 2. マイクロサービス詳細解析用プロンプト

#### 2.1 サービスのエントリーポイント

- **目的**: サービス分析の起点と重要コード位置を明確化
- **想定結果**: 効率的なコード探索・原因調査が可能

```text
「[サービス名] の解析開始点を教えてください：
- メインアプリケーションクラス
- 主要コントローラクラス群
- 主要エンティティと関係
- サービス層実装箇所
- 主な設定ファイルやREADME」
```

#### 2.2 サービス依存関係分析

- **目的**: 外部リソース・内部/外部サービスの実態や依存全体像を整理
- **想定結果**: デバッグやスケーリングポイントの特定に役立つ

```text
「[サービス名] マイクロサービスの依存先を分析してください：
- 依存する外部サービス
- 利用するDBやデータストア
- 他サービスとの通信手法
- 外部ライブラリ/フレームワーク
- 必須設定・秘密管理手法」
```

#### 2.3 サービス設定理解

- **目的**: 起動・運用・セキュリティ観点でのサービス設定内容を把握
- **想定結果**: 設定変更・障害対応に強くなる

```text
「[サービス名] のSpring Boot設定を確認してください：
- application.properties/yml＆プロファイル
- セキュリティ設定全般
- DB設定（JPA、プール）
- キャッシュ設定（Redis等）
- 外部API/OAuth連携設定
- モニタリング・ヘルスチェック」
```

### 3. エンドポイントAPI解析用プロンプト

#### 3.1 全体エンドポイント探索

- **目的**: 全マイクロサービスを横断するAPIエンドポイントの全量把握
- **想定結果**: フロント/統合開発・APIインベントリ作成支援  

```text
「全RESTエンドポイントを調べてください：
- コントローラ一覧
- エンドポイントをユーザー種別（公開/認証ユーザー/管理者等）で分類
- 各エンドポイントのHTTPメソッド・パス
- 特定ロール・権限要件
- 主要エンドポイントグループの説明
- 廃止/実験的エンドポイントの把握」
```

#### 3.2 サービス単体エンドポイント分析

- **目的**: 指定サービスのAPI一覧・構造・仕様・検証方法を明確化
- **想定結果**: サービス機能拡張・統合・テストの事前調査に有効

```text
「[サービス名] の全RESTエンドポイント情報をください：
- HTTPメソッド・パス
- リクエスト/レスポンス構造
- 認証・認可要件
- 入力バリデーション・エラー返却
- 主要APIの利用サンプル」
```

#### 3.3 API連携パターン

- **目的**: サービス横断APIコールの仕組み・信頼性対策等の全体像理解
- **想定結果**: サービス連携拡張や障害時対策設計に役立つ

```text
「このマイクロサービスが他サービスとどのように統合されているかを分析してください：
- [サービス名]が他サービスから呼び出すAPI
- コールの実装技術（RestTemplate, WebClient, Feign等）
- エラー/リトライ・サーキットブレーカ
- サービスディスカバリ設定
- 分散トランザクション制御」
```

### 4. システムアーキテクチャ図プロンプト

#### 4.1 上位アーキテクチャ図

- **目的**: 全システムモジュール・外部連携・セキュリティ・監視等の俯瞰図作成
- **想定結果**: 問題点抽出や関係者説明・ドキュメント化等に有効  

```text
「このスキーショップマイクロサービスシステムの包括的アーキテクチャ図を作成してください：
- 全10サービスの主要役割
- サービス間・DB間データフロー
- 外部連携（Azure Entra ID, AIサービス等）
- 負荷分散・API Gatewayのルーティング
- 監視・ログ基盤
- セキュリティ区画や認証フロー
（ASCIIアートや図に変換しやすい形で）」
```

#### 4.2 サービス連携図

- **目的**: 時系列のサービス間連携フロー・認証トークン流れ等の可視化
- **想定結果**: 新機能の設計・ボトルネック特定・トラブル対応力向上

```text
「サービス連携図を作成してください：
- フロントからバックエンド全体
- API Gateway役割
- 認証トークンの流れ
- データ同期・イベント
- キャッシュレイヤ連携」
```

#### 4.3 データベースアーキテクチャ図

- **目的**: 各サービス所有データ・エンティティ関係・サービス間データ型依存を可視化
- **想定結果**: マイグレーションや機能追加計画・運用安定性向上等に寄与

```text
「次を示すDBアーキテクチャ図を作成してください：
- どのサービスがどのDB（PostgreSQL, Redis）を使用
- サービス内エンティティリレーション
- サービス横断データ依存
- データの整合性確保・バックアップ/冗長化
- マイグレーション・バージョン管理」
```

### 5. フロントエンドサービスコールのシーケンス図

#### 5.1 顧客購入フロー

- **目的**: 商品購入業務のマルチサービス時系列分解・実装工程明確化
- **想定結果**: フルE2E構築・テスト・デバッグガイド  

```text
「顧客購入の詳細シーケンス図を作成してください：
- フロントエンド（Thymeleafコントローラ）
- API Gateway
- Authentication Service（諸認証）
- Inventory Management Service（在庫照会）
- Point Service（ポイント残高・利用）
- Coupon Service（クーポン適用）
- Payment Cart Service（決済処理）
- Sales Management Service（受注作成）
具体的なHTTPリクエスト・トークン伝播・エラー処理・DBトランザクションも」
```

#### 5.2 管理ダッシュボードデータ読込

- **目的**: 管理画面の複数サービス統合・情報集約モデル化
- **想定結果**: 効率よいダッシュボードロード・設計最適化指針

```text
「管理者ダッシュボードのデータロードシーケンス図を作成してください：
- 管理コントローラからのダッシュボードロード
- 認証・認可ステップ
- バックエンド複数APIパラレル取得
- Sales, Inventory, User, Point, Coupon各情報
- データ集約・Thymeleaf表示
- WebSocketによるリアルタイム通知」
```

#### 5.3 AIチャットフロー

- **目的**: AIチャット実現の全体的なコール/連携/文脈流れ追跡
- **想定結果**: 拡張・デバッグ時の技術参照可能

```text
「AIチャットのシーケンス図を作成してください：
- フロントのチャット開始
- API Gateway→AI Support Service
- LangChain4jでのクエリ処理
- 推奨アルゴリズムとの連携
- 応答生成・前方ストリーム返却
- チャット履歴保存
- ユーザープロフィールや購買履歴連携」
```

#### 5.4 リアルタイム機能

- **目的**: WebSocket等のリアルタイム連携設計と挙動モデル化
- **想定結果**: 在庫通知・注文状況更新等のハンドリング設計に使える  

```text
「リアルタイム機能のシーケンス図：
- WebSocket接続
- リアルタイム在庫・注文更新
- ポイント残高等のPush通知
- 同時多数接続・再接続処理」
```

#### 5.5 決済処理

- **目的**: 決済～受注・ポイント・クーポン同期～通知まで
- **想定結果**: フルペイメントE2E設計・安全性分析サンプル

```text
「決済フローのシーケンス図：
- 顧客→フロントエンド検証→API Gateway→Payment Cart Service
- Sales Management→受注・在庫減算
- Point/Coupon適用
- 完了メール発信
- User Management更新」
```

### 6. 高度統合パターン

#### 6.1 パフォーマンス最適化

- **目的**: 認証・ユーザー管理サービス間の最適化ポイント把握
- **想定結果**: キャッシュ、接続プール等パフォーマンスベストプラクティス整理

```text
「Authentication・User Managementサービス連携のパフォーマンス最適化策を分析してください：
- キャッシュ適用箇所・期間
- 接続プール・リトライ設計
- パフォーマンスボトルネック
- レスポンス時間短縮
- モニタリング指標」
```

#### 6.2 スケーラビリティとレジリエンス

- **目的**: 高負荷・障害発生時の可用性設計・復旧手段明確化
- **想定結果**: サーキットブレーカー・フェイルオーバー等、実務復旧パターン準備

```text
「サービスのスケーラビリティ／レジリエンス設計策を分析してください：
- 独立スケーリング方法
- サービス高負荷時のオプション
- サーキットブレーカー導入有無
- バックアップ・フェイルオーバー構成
- 大量認証トラフィック時の対策
- ディザスタリカバリ検討ポイント」
```

### 7. フロントエンド実装プロンプト

#### 7.1 プロジェクト構成

```text
「新規Spring Bootフロントエンドマイクロサービスの立ち上げ支援をしてください：
- Spring Boot 3.2のMaven初期プロジェクト構成
- pom.xml必須依存一覧（Thymeleaf・Spring Security・APIクライアント等）
- 顧客・管理者画面のための推奨パッケージ構成
- コントローラ／サービス／設定の層分け
- メインアプリクラス・基本設定サンプル」
```  

#### 7.2 デザイン仕様分析

```text
「design-docs/frontend-design.md・all-endpoint-list.mdを分析し：
- 顧客インタフェースの主要要件リスト
- 管理者インタフェース主要要件リスト
- デュアルテーマ実装の設計
- ページレイアウト・ナビゲーション構成
- ユーザータイプ毎の必須APIエンドポイント」
```

#### 7.3 顧客画面実装

```text
「顧客用ライトブルーテーマ画面実装支援：
- トップ・商品カタログ・詳細ページのThymeleaf生成
- カート・チェックアウトUI
- プロフィール・履歴
- AIチャット画面
- ライトブルーCSSコード自動生成
- Bootstrapでレスポンシブ対応
- 顧客用MVCコントローラ自動化
API連携：
- 商品検索GET /api/products/search
- カートPOST /api/v1/cart/items
- 注文POST /api/v1/orders
- ポイントGET /api/v1/points/balance
- AI推薦GET /api/v1/recommendations/{userId}
」
```

#### 7.4 管理者画面実装

```text
「管理画面ライトレッドテーマ実装支援：
- ダッシュボード＋分析レポートThymeleaf生成
- 商品・在庫・注文・ユーザー管理UI
- データ可視化・ページネーション
- バッチ処理用コンポーネント
API統合：
- 商品管理POST /api/products, PUT /api/categories/{id}
- 注文PUT /api/v1/orders/{orderId}/status
- ユーザーGET /api/admin/users
- レポートGET /api/v1/reports/sales
- キャンペーンPOST /api/v1/campaigns
」
```

#### 7.5 認証・セキュリティ

```text
「デュアルテーマ認証・セキュリティ実装：
- Azure Entra ID OAuth 2.0設定
- ロール制御
- 顧客・管理者ログイン・ログアウト処理
- セッション管理
- CSRF・セキュリティヘッダ
- アクセスルール分岐
- 未認証時エラーUI」
```

#### 7.6 API統合とエラーハンドリング

```text
「API連携の堅牢性強化：
- RestTemplate/WebClientの設定
- API異常時のエラーハンドラー
- リトライとサーキットブレーカー
- DTOクラス自動生成
- キャッシュ戦略
- APIコールログ
- サービスダウン時のフォールバックUI」
```

#### 7.7 テストと品質保証

```text
「フロントエンド包括テストの自動生成：
- MVCコントローラユニットテスト
- API統合テスト
- E2E(顧客・管理者フロー)
- 認証テスト
- パフォーマンステスト
- クロスブラウザテスト
- レスポンシブ・デバイス別テスト
- 顧客・管理者テストデータ自動生成」
```

#### 7.8 設定・デプロイ

```text
「フロントサービスの設定・デプロイ支援：
- application.yml（複数環境プロファイル付）
- API Gateway + サービスディスカバリ設定
- モニタリング、ヘルスチェック
- Docker化
- ログ・メトリクス
- 環境毎の設定管理
- グレースフルシャットダウン／起動
- 負荷分散・スケーリング設計」
```

---

ワークショップの内容を通じて、GitHub Copilot Agentの活用方法や、Spring Bootマイクロサービス開発の実践的なスキルを身につけてください。
